# 2022/10/26

## ì˜¤ëŠ˜ ê³µë¶€í•œ ë‚´ìš©

## Babel

> Babelì€ Javascript **ì»´íŒŒì¼ëŸ¬(Complier)**ì´ë‹¤. (Transplierê°€ ì•„ë‹Œ Complierì´ë‹¤.)

- ì°¨ì„¸ëŒ€ Javascript ë¬¸ë²•ì„ ì‚¬ìš©í•˜ë„ë¡ ë¸Œë¼ìš°ì € í˜¸í™˜ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.

### Babelì´ í•˜ëŠ” ì¼

1. êµ¬ë¬¸ ë³€í™˜
2. ëŒ€ìƒ í™˜ê²½ì— ëˆ„ë½ëœ í´ë¦¬í•„ ê¸°ëŠ¥ (core-js@3 í´ë¦¬í•„ ì‚¬ìš©)

> ğŸ¤”Â **í´ë¦¬í•„ì´ë€?**
> ë³€ê²½ëœ í‘œì¤€ì„ ì¤€ìˆ˜í•  ìˆ˜ ìˆê²Œ ê¸°ì¡´ í•¨ìˆ˜ì˜ ë™ì‘ ë°©ì‹ì„ ìˆ˜ì •í•˜ê±°ë‚˜, ìƒˆë¡­ê²Œ êµ¬í˜„í•œ í•¨ìˆ˜ì˜ ìŠ¤í¬ë¦½íŠ¸

3. ì†ŒìŠ¤ ì½”ë“œ ë³€í™˜ (codemods)

---

ğŸ’¡Â **CDN(Content Delivery Network)ë€?**

- ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ê¸°ìˆ 
- ì¥ì 
  - ì‚¬ìš©ì ìœ„ì¹˜ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
  - ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤.

---

### ì„¤ì¹˜

```bash
npm i -D @babel/core @babel/cli @babel/preset-env
```

- @babel/core : ë°”ë²¨ì˜ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì„ ë‹´ì€ ì½”ì–´
- @babel/cli : ë°”ë²¨ì˜ command-line interface
- @babel/preset-env : ìµœì‹  í”ŒëŸ¬ê·¸ì¸ê¹Œì§€ ë‹´ê³ ìˆëŠ” í”ŒëŸ¬ê·¸ì¸ ëª¨ìŒ

---

ğŸ‘Â ìœ ìš©í•œ í™•ì¥ í”„ë¡œê·¸ë¨

- hide node modules : node_modules íŒŒì¼ì„ ì œì™¸ ìœ /ë¬´ë¥¼ í† ê¸€í•˜ëŠ” ê¸°ëŠ¥
- Search node_modules : node_modules ë‚´ì— ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

---

> ğŸ¤”Â package.jsonì˜ scripts ëª…ë ¹ì–´ì— npx ë¶™ì´ëŠ” ê²½ìš°?
> npxì˜ ê²½ìš° ë¨¼ì € í•´ë‹¹ íŒŒì¼ì´ ê¹”ë ¤ìˆëŠ”ì§€ë¶€í„° í™•ì¸í•˜ëŠ”ë°,
> ê¹”ë ¤ìˆë‹¤ë©´ npxë¥¼ ìƒëµí•´ë„ ë˜ê³ , ê¹”ë ¤ìˆì§€ ì•Šë‹¤ë©´ npxëª…ë ¹ì–´ê°€ í•„ìˆ˜ì´ê¸° ë•Œë¬¸ì— ë¶™ì—¬ì£¼ì–´ì•¼ í•œë‹¤.

### ëª…ë ¹ì–´

- `npx babel -h` : ë°”ë²¨ ë„ì›€ë§ ë³´ê¸°

  <img src="./2022-10-26-images/1.png">

---

ğŸ’¡Â `globalThis` ë€?

- ì˜ˆë¥¼ ë“¤ì–´, ë¸Œë¼ìš°ì €ëŠ” ì „ì—­ìœ¼ë¡œ ì ‘ê·¼í•  ë•Œ, window, this, selfë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ globalë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤. í•˜ì§€ë§Œ node.jsì—ì„œëŠ” globalë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
- ì´ë¥¼ í†µì¼í•´ì£¼ê¸° ìœ„í•´ì„œ `globalThis` ë¼ëŠ” í‘œí˜„ìœ¼ë¡œ ì „ì—­ìœ¼ë¡œ ì ‘ê·¼í•œë‹¤.

---

### ì„¤ì •

```jsx
// babel.config.js íŒŒì¼ ë‚´ì—ì„œì˜ ì„¤ì •

module.exports = {
  preset: [
    [
      "@babel/preset-env",
      {
        // targetsì˜ ë²”ì£¼ë‚´ê°€ ë˜ë„ë¡ babelì´ complie í•œë‹¤.
        targets: "> 0.25% in KR, last 2 versions, node > 16, ie 9-11",
      },
    ],
  ],
};
```

- ìœ„ì™€ ê°™ì´ Babel êµ¬ì„± íŒŒì¼ì— targets ì„¤ì •ì„ ì‚¬ìš©í•´ ì§€ì› ëŒ€ìƒ í™˜ê²½(ì›¹ ë¸Œë¼ìš°ì €, Node, ì¼ë ‰íŠ¸ë¡  ë“±)ì„ ì„¤ì •í•  ìˆ˜ ìˆì§€ë§Œ [Browserslist](https://browsersl.ist/) êµ¬ì„± íŒŒì¼ì„ ë³„ë„ë¡œ ë§Œë“¤ì–´ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.

  ```jsx
  // .browserslistrc

  > 0.25% in KR // í•œêµ­ì—ì„œ ì ìœ ìœ¨ì´ 0.25% ë„˜ëŠ” ê²ƒë§Œ
  last 2 versions // ê°€ì¥ ìµœì‹ ì—ì„œ 2 ë²„ì „ê¹Œì§€
  node > 16 // node 16ë²„ì „ ì´ìƒ
  ie 9-11 // IE 9-11
  ```

- ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ë˜ëŠ” ë¸Œë¼ìš°ì € ë¦¬ìŠ¤íŠ¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.
  ```jsx
  npx browserslist ">0.25% in KR, last 2 versions, node > 16,  not dead, ie 9-11"
  ```
- ë‹¤ìŒ ì‚¬ì´íŠ¸ë¥¼ ì´ìš©í•˜ë©´ ë‚´ê°€ ì„¤ì •í•œ ì§€ì› ëŒ€ìƒ í™˜ê²½ì„ ì‹œê°ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.
  [Browserslist](https://browserslist.dev/?q=bGFzdCAyIHZlcnNpb25zLCBub2RlID4gMTYsIG5vdCBkZWFkLCBpZSA5LTEx)

```jsx
module.exports = {
  comments: false,
  presets: [
    [
      "@babel/preset-env",
      {
        modules: false,
        useBuiltIns: "usage",
        corejs: "3.26.0",
      },
    ],
  ],
};
```

- ì»´íŒŒì¼ì‹œ ì£¼ì„ì„ í¬í•¨í•˜ê¸° ì‹«ë‹¤ë©´ `comments: false` ë¥¼ í•´ì¤€ë‹¤.
- `modules: false`ë¡œ í•˜ì—¬ requiredê°€ ì•„ë‹Œ importë¡œ ë³€í™˜ ë˜ë„ë¡ í•œë‹¤.
  - requiredëŠ” ë¸Œë¼ìš°ì €ì—ì„œ referenceErrorê°€ ëœ¨ê¸° ë•Œë¬¸
- `useBuiltIns`ì˜ ë””í´íŠ¸ ê°’ì€ falseì´ë¯€ë¡œ ì‚¬ìš©í•´ì£¼ê¸° ìœ„í•´ì„œëŠ” usageë¡œ ì‘ì„±
- corejsëŠ” í•´ë‹¹ ë””ë ‰í† ë¦¬ì—ì„œ `npm show core-js version` ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ˆì§€ë§‰ ë²„ì „ì„ í™•ì¸í•œ í›„ ë²„ì „ì„ ëª…ì‹œí•´ì¤€ë‹¤. (`npm show core-js versions` ì‚¬ìš© ì‹œ ë²„ì „ ëª©ë¡ë“¤ì„ ë°°ì—´ë¡œ ë°˜í™˜í•œë‹¤)

## Jest

> í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ(TDD, Test Driven Development)ì„ ìœ„í•œ í™˜ê²½ì„ êµ¬ì„±í•œë‹¤.

### ì„¤ì¹˜

- íŒ¨í‚¤ì§€ ì„¤ì¹˜

  ```bash
  npm i -D jest
  ```

- Jest êµ¬ì„± íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ì´ˆê¸°í™” ëª…ë ¹ì„ ì‹¤í–‰(jest.config.js íŒŒì¼ì´ ìƒì„±ëœë‹¤)

  ```bash
  npx jest --init
  ```

  ```bash
  # ë‹¤ìŒ ì§ˆë¬¸ì€ Jestê°€ í”„ë¡œì íŠ¸ì— ì í•©í•œ êµ¬ì„±ì„ ë§Œë“œëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
  The following questions will help Jest to create
  a suitable configuration for your project

  # "package.json"ì—ì„œ "test" ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ Jestë¥¼ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
  âœ” Would you like to use Jest when running "test" script in "package.json"?
  â€¦ yes

  # êµ¬ì„± íŒŒì¼ì— Typescriptë¥¼ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
  âœ” Would you like to use Typescript for the configuration file?
  â€¦ no

  # í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„ íƒ
  âœ” Choose the test environment that will be used for testing
  â€º jsdom (browser-like)

  # Jestê°€ ì»¤ë²„ë¦¬ì§€ ë³´ê³ ì„œë¥¼ ì¶”ê°€í•˜ê¸°ë¥¼ ì›í•˜ì‹­ë‹ˆê¹Œ?
  Do you want Jest to add coverage reports?
  â€¦ no

  # ì»¤ë²„ë¦¬ì§€ ëª©ì ìœ¼ë¡œ ì½”ë“œë¥¼ ê³„ì¸¡í•˜ë ¤ë©´ ì–´ë–¤ ê³µê¸‰ìë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆê¹Œ?
  Which provider should be used to instrument code for coverage?
  â€º babel

  # ëª¨ë“  í…ŒìŠ¤íŠ¸ ì „ì— ëª¨ì˜ í˜¸ì¶œ, ì¸ìŠ¤í„´ìŠ¤, ì»¨í…ìŠ¤íŠ¸ ë° ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?
  Automatically clear mock calls, instances, contexts & results before every test?
  â€¦ no
  ```

  - package.jsonì˜ scriptsì— `"test": "jest"`ê°€ ìë™ìœ¼ë¡œ ì¶”ê°€ëœë‹¤.
    - `"test": "jest --watch"` ì‹œ ê³„ì†í•´ì„œ í™•ì¸í•œë‹¤.

- ì—¬ê¸°ì„œ ê·¸ëƒ¥ npm testë¥¼ í•´ë²„ë¦¬ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ëœ¬ë‹¤

  <img src="./2022-10-26-images/2.png">

  - jest-environment-jsdomê°€ í•„ìš”í•˜ë‹¤ê³  í•˜ë‹ˆ ì„¤ì¹˜í•´ì£¼ë„ë¡ í•œë‹¤.

  ```bash
  npm i -D jest-environment-jsdom
  ```

---

**ğŸ’¡Â ëª¨ë“ˆ ë°©ì‹ (commonJS vs ESM)**

- Node.jsëŠ” ê¸°ë³¸ì ìœ¼ë¡œ CommonJS ëª¨ë“ˆ ë°©ì‹ì„ ì§€ì›
- importë¥¼ ì“¸ ìˆ˜ ìˆëŠ” ìƒí™©ì—ì„œëŠ” import ì‚¬ìš©
- ESMì€ Javascript í‘œì¤€ì´ê³ , CommonJSëŠ” Node.jsê°€ ì±„íƒí•œ ê¸°ë³¸ê°’
- ë¬¸ë²•

1. commonJS

```jsx
// ë‚´ë³´ë‚´ê¸°
module.exports = { getRandom, getRandomMinMax };

// ê°€ì ¸ì˜¤ê¸°
const { getRandom, getRandomMinMax } = require("./getRandom");
```

2. ESM

```jsx
// ë‚´ë³´ë‚´ê¸° (ì•ì— export)
export const getRandom = (n) => Math.round(Math.random() * n);
export const getRandomMinMax = (min = 0, max = 100) =>
  getRandom(max - min) + min;

// ê°€ì ¸ì˜¤ê¸°
import { getRandom, getRandomMinMax } from "./getRandom.js";
```

---

### ì„¤ì •

- jest.config.js

```jsx
// **jest.config.js**

module.exports = {
	testEnvironment: 'jsdom',
	transform: {
    **'\\.js$': 'babel-jest',**
  },
	testPathIgnorePatterns: ['/node_modules/'],
	setupFilesAfterEnv: ['./jest.setup.js'],
}
```

- jest.setup.js

```jsx
// 1. jest.setup.js íŒŒì¼ì„ ë§Œë“ ë‹¤
// 2. jest.config.jsì˜ ì„¤ì • ì¤‘ setupFilesAfterEnv: ['./jest.setup.js']ì™€ ì—°ê²°ëœë‹¤.

import "regenerator-runtime";
```

- eslintrc.yml

```yaml
// eslintrc.yml
// êµµì€ ê¸€ì”¨ ë¶€ë¶„ ì¶”ê°€

env:
  browser: true
  commonjs: true
  es2021: true
  node: true
  **jest/globals: true**
extends:
  - eslint:recommended
  **- plugin:jest/recommended**
  - prettier
parserOptions:
  ecmaVersion: latest
  **sourceType: module**
**plugins:
  - jest**
rules: { no-unused-vars: warn }
```

## DOM í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

### ì„¤ì¹˜

```bash
npm i -D @testing-library/jest-dom
```

### ì„¤ì •

- **jest.setup.js**

```jsx
// jest.setup.js (êµµì€ ê¸€ì”¨)

import "regenerator-runtime";
import "@testing-library/jest-dom";
```

## ëŠë‚€ì 

- ì˜¤ëŠ˜ì€ Babelê³¼ Jestì— ëŒ€í•´ì„œ ë°°ì› ëŠ”ë°, ì´ì „ì—ëŠ” Babelì€ ê·¸ëƒ¥ í˜¸í™˜ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê²ƒìœ¼ë¡œë§Œ ì•Œê³  ë§¤ë‰´ì–¼ëŒ€ë¡œ ì„¤ì¹˜í•˜ê³  ë„˜ì–´ê°”ì§€ë§Œ, ì´ë²ˆì—ëŠ” ê°ê° ì„¤ì •ë“¤ì´ ë¬´ì—‡ì„ ëœ»í•˜ê³  ì–´ë– í•œ ì—­í• ì„ í•˜ëŠ”ì§€ ì•Œê³  ì„¤ì¹˜í•˜ì˜€ë‹¤. ë˜í•œ ì´ì „ì— Jestë¥¼ ì‚¬ìš©í•˜ì˜€ì„ ë•Œë„ ìˆëŠ” test ì½”ë“œë¥¼ ê°€ì ¸ë‹¤ê°€ ì‚¬ìš©í–ˆëŠ”ë°, ì´ test ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒë„ ë§Œë§Œì¹˜ ì•Šë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. ë˜í•œ ê³¼ì—° TDDë¥¼ ìœ„í•´ì„œ ì •ë§ ë‹¤ì–‘í•œ ê²½ìš°ì˜ testë¥¼ ì‘ì„±í•  ìˆ˜ ìˆì„ê¹Œë¼ëŠ” ìƒê°ë„ ë“¤ì—ˆë‹¤. ì–´ì œì— ì´ì–´ í™˜ê²½ì„¤ì •ì— ëŒ€í•´ì„œ ë°°ìš°ëŠ”ë°, React í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ì •ë§ë¡œ ë§ê³  ë‹¤ì–‘í•œ ì„¤ì •ë“¤ì´ ì–½í˜€ ì¤€ë¹„ë˜ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ëŠë¼ëŠ” ì ì€ í•˜ë‚˜í•˜ë‚˜ ì„¤ì¹˜í•  ë•Œë§ˆë‹¤ ì‚¬ëŒë“¤ì´ ëŠë¼ëŠ” ë¶ˆí¸í•¨ì€ ê°™ê³  ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ extensionê³¼ ì„¤ì •ë“¤ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ë³´ê³  ë†€ë¼ì› ë‹¤. ì´ë¥¼ ë³´ê³  ë‚˜ë„ ì‚¬ëŒë“¤ì´ ë¶ˆí¸í•¨ì„ ëŠë‚„ ë¶€ë¶„ì„ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ extensionì„ ë§Œë“¤ì–´ ë³´ë©´ ì–´ë–¨ê¹Œë¼ëŠ” ìƒê°ë„ ë“¤ì—ˆë‹¤.
